<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Neural Networks | David Álvarez Rosa | Personal Blog</title>
    <meta charset="UTF-8" />
    <meta name="description" content="Implementing a Neural Network from scratch
                                      in C++ - Part 1 - The theory | David
                                      Álvarez Rosa | Personal Blog" />
    <meta name="keywords" content="Neural Network, C++, Scratch, Fully
                                   Connected, Artificial Intelligence, Deep
                                   Learning, Implementing, David Álvarez Rosa,
                                   David Álvarez, David, Personal Blog, Blog,
                                   Entry, Mathematics, Engineering, Technology" />
    <meta name="author" content="David Álvarez Rosa" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="canonical"
          href="https://david.alvarezrosa.com/blog/neural-network.html" />
    <link rel="icon" type="image/x-ico" href="images/favicon.ico" />
    <link rel="apple-touch-icon" sizes="158x180" href="images/apple-touch-icon.png">
    <link rel="stylesheet" href="css/main.css" />
    <link rel="stylesheet" href="css/blog.css" />
    <link rel="stylesheet" href="css/animations.css" />
    <link rel="stylesheet" href="fontawesome/css/fontawesome.css" />
    <link rel="stylesheet" href="fontawesome/css/solid.css" />
    <link rel="stylesheet" href="fontawesome/css/brands.css" />
    <link rel="stylesheet" href="highlight/styles/atom-one-dark.css" />
    <script type="application/ld+json">
	    {
		      "@context":"http://schema.org",
		      "@type": "BlogPosting",
		      "image": "https://blog.alvarezrosa.com/neural-network.jpeg",
		      "url": "https://blog.alvarezrosa.com/neural-networks-part1.html",
		      "headline": "Neural Networks - Part 1",
		      "alternativeHeadline": "Neural Networks",
		      "dateCreated": "2019-02-11T11:11:11",
		      "datePublished": "2019-02-11T11:11:11",
		      "dateModified": "2019-02-11T11:11:11",
		      "inLanguage": "en-US",
		      "isFamilyFriendly": "true",
		      "copyrightYear": "2020",
		      "copyrightHolder": "",
		      "author": {
			        "@type": "Person",
			        "name": "David Álvarez Rosa",
			        "url": "https://david.alvarezrosa.com"
		      },
		      "creator": {
			        "@type": "Person",
			        "name": "David Álvarez Rosa",
			        "url": "https://david.alvarezrosa.com/"
		      },
		      "genre":["SEO","JSON-LD"],
		      "articleSection": "Uncategorized posts",
		      "articleBody": "Paste the body of your content in here in plaintext"
	    }
    </script>
  </head>


  <!--
	Alright, you can look at this code - but only if you solve this maze within
	10 seconds. David.

	Start.

	aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa   a
	8   8               8               8           8                   8   8
	8   8   aaaaaaaaa   8   aaaaa   aaaa8aaaa   aaaa8   aaaaa   aaaaa   8   8
	8               8       8   8           8           8   8   8       8   8
	8aaaaaaaa   a   8aaaaaaa8   8aaaaaaaa   8aaaa   a   8   8   8aaaaaaa8   8
	8       8   8               8           8   8   8   8   8           8   8
	8   a   8aaa8aaaaaaaa   a   8   aaaaaaaa8   8aaa8   8   8aaaaaaaa   8   8
	8   8               8   8   8       8           8           8       8   8
	8   8aaaaaaaaaaaaaaa8aaa8   8aaaa   8   aaaaa   8aaaaaaaa   8   aaaa8   8
	8           8       8   8       8   8       8           8   8           8
	8   aaaaa   8aaaa   8   8aaaa   8   8aaaaaaa8   a   a   8   8aaaaaaaaaaa8
	8       8       8   8   8       8       8       8   8   8       8       8
	8aaaaaaa8aaaa   8   8   8   aaaa8aaaa   8   aaaa8   8   8aaaa   8aaaa   8
	8           8   8           8       8   8       8   8       8           8
	8   aaaaa   8   8aaaaaaaa   8aaaa   8   8aaaa   8aaa8   aaaa8aaaaaaaa   8
	8   8       8           8           8       8   8   8               8   8
	8   8   aaaa8aaaa   a   8aaaa   aaaa8aaaa   8   8   8aaaaaaaaaaaa   8   8
	8   8           8   8   8   8   8           8               8   8       8
	8   8aaaaaaaa   8   8   8   8aaa8   8aaaaaaa8   aaaaaaaaa   8   8aaaaaaa8
	8   8       8   8   8           8           8   8       8               8
	8   8   aaaa8   8aaa8   aaaaa   8aaaaaaaa   8aaa8   a   8aaaaaaaa   a   8
	8   8                   8           8               8               8   8
	8   8aaaaaaaaaaaaaaaaaaa8aaaaaaaaaaa8aaaaaaaaaaaaaaa8aaaaaaaaaaaaaaa8aaa8

	End.
	-->


  <body class="preload">
    <!-- Loading spinner. -->
    <div id="loadingSpinner"></div>


    <!-- Information divs. -->
    <div class="info" id="welcomeUser" style="width: 600px; left: calc(50% - 600px/2);">
      <p>
        This website is under construction. Please, be patient.
      </p>
      <a href="https://whatwg.org/"
         rel="nofollow noopener"
         target="_blank"
         title="HTML website.">
        <img data-src="images/html.png"
             style="float: left; margin-left: 30px;"
             height="150px"
             alt="HTML logo." />
      </a>
      <a href="https://www.w3.org/Style/CSS/Overview.en.html"
         rel="nofollow noopener"
         target="_blank"
         title="Cascading Style Sheets home page.">
        <img data-src="images/css.png"
             style="float: right; margin-right: 30px;"
             height="150px"
             alt="CSS logo." />
      </a>
      <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript"
         rel="nofollow noopener"
         target="_blank"
         title="JavaScript website.">
        <img data-src="images/js.png"
             style="float: right; margin-right: 30px;"
             height="150px"
             alt="JavaScript logo." />
      </a>
      <div style="clear: both;"></div>
      <p style="font-size: .8em; margin-top: 3.5em;">
        You can exit by pressing q or ESC or clicking outside this box.
      </p>
    </div>

    <div class="info" id="welcomeEmacsUser">
      <p>
        Hey Emacs user! You are more than welcome. You may be interested in
        checking out my
        <a href="https://gitlab.com/DavidAlvarez/dotfiles/blob/master/.emacs.d/config.org"
           title="My Emacs cofiguration files."
           rel="external noopener"
           target="_blank">
          Emacs configuration <i class="fas fa-external-link-alt"></i>
        </a>.
      </p>
      <a href="https://www.gnu.org/software/emacs/"
         rel="nofollow noopener"
         target="_blank"
         title="GNU Emacs official website.">
        <img data-src="images/emacs.png"
             style="float: left; margin-left: 30px;"
             height="150px"
             alt="Emacs icon." />
      </a>
      <a href="https://stallman.org"
         rel="nofollow noopener"
         target="_blank"
         title="Richard Stallman's Personal Site.">
        <img data-src="images/richard_stallman.png"
             style="float: right; margin-right: 30px;"
             height="150px"
             alt="Richard Stallmann with Emacs icon." />
      </a>
      <div style="clear: both;"></div>
      <p style="font-size: .8em; margin-top: 2em;">
        You can exit by pressing q or ESC or clicking outside this box.
      </p>
    </div>

    <div class="info" id="welcomeVimUser">
      <p>
        Hey Vim user! You are more than welcome.
      </p>
      <a href="https://www.vim.org/"
         rel="nofollow noopener"
         target="_blank"
         title="Vim official website.">
        <img data-src="images/vim.png"
             style="margin-left: calc(50% - 175px/2);"
             width="175px"
             alt="Vim icon." />
      </a>
      <div style="clear: both;"></div>
      <p style="font-size: .8em; margin-top: 1.5em;">
        You can exit by pressing q or ESC or clicking outside this box.
      </p>
    </div>

    <div class="info" id="welcomeNoobUser" style="height: 550px; top: calc(50% - 550px/2 - 18px);">




























      <!-- <i class="fas fa-times fa-lg" -->
      <!--    style="position: absolute; top: 8px; right: 8px;"></i> -->























      <p>
        Hey visitor! It seems that you like to use the keyboard to
        scroll. Please consider <em>upgrading</em> to (probably) better shortcuts.
      </p>
      <ul style="float: left; margin-left: 25px;">
        <li style="margin-left: 32px;"><strong>Emacs</strong></li>
        <li><strong>n</strong>: scroll next.</li>
        <li><strong>p</strong>: scroll previous.</li>
        <li><strong>f</strong>: forward section.</li>
        <li><strong>b</strong>: backward section.</li>
        <li><strong>&lt;</strong>: go top.</li>
        <li><strong>&gt;</strong>: go bottom.</li>
      </ul>
      <ul style="float: right; margin-right: 50px;">
        <li style="margin-left: 35px;"><strong>Vim</strong></li>
        <li><strong>j</strong>: scroll next.</li>
        <li><strong>k</strong>: scroll previous.</li>
        <li><strong>l</strong>: forward section.</li>
        <li><strong>h</strong>: backward section.</li>
        <li><strong>g</strong>: go top.</li>
        <li><strong>G</strong>: go bottom.</li>
      </ul>
      <div class="clear"></div>
      <ul style="margin-top: 1em; margin-left: 150px;">
        <li style="margin-left: 35px;"><strong>Others</strong></li>
        <li><strong>d</strong>: scroll down.</li>
        <li><strong>u</strong>: scroll up.</li>
        <li><strong>m</strong>: toggle navigation.</li>
        <li><strong>space</strong>: toggle animation.</li>
        <li><strong>arrows</strong>: prev/next background.</li>
        <li><strong>?</strong> or <strong>H</strong>: show this help.</li>
      </ul>
      <p style="font-size: .8em; margin-top: 1.5em;">
        You can exit by pressing q or ESC or clicking outside this box.
      </p>
    </div>

    <div class="info" id="welcomeChromeUser" style="height: 325px; top: calc(50% - 325px/2);">
      <p>
        Hey visitor! It seems that you are using Google Chrome. You are more
        than welcome, but your browser is not: read
        <a href="https://www.gnu.org/proprietary/malware-google.html"
           title="Google's Software is Malware."
           rel="nofollow noopener"
           target="_blank">
          why <i class="fas fa-external-link-alt"></i>
        </a>.
        Please consider changing it.
      </p>
      <a href="https://qutebrowser.org/"
         rel="nofollow noopener"
         target="_blank"
         title="Qutebrowser official website.">
        <img data-src="images/qutebrowser.png"
             style="float: left; margin-left: 30px;"
             height="150px"
             alt="Qutebrowser icon." />
      </a>
      <a href="https://gnu.org"
         rel="nofollow noopener"
         target="_blank"
         title="GNU Operating System official website.">
        <img data-src="images/gnu.png"
             style="float: right; margin-right: 30px;"
             height="150px"
             alt="GNU Operating System icon." />
      </a>
      <div class="clear"></div>
      <p style="font-size: .8em; margin-top: 2em;">
        You can exit by pressing q or ESC or clicking outside this box.
      </p>
    </div>

    <div class="info" id="infoEmail">
      <p>
        This is my email. For security reasons it has been included as an
        image.
      </p>
      <a href="images/email.png"
         title="Personal email.">
        <img data-src="images/email.png"
             style="margin-left: calc(50% - 200px/2);"
             width="200px"
             alt="Personal email." />
      </a>
      <p style="font-size: .8em; margin-top: 1.75em;">
        You can exit by pressing q or ESC or clicking outside this box.
      </p>
    </div>

    <div class="info" id="infoPhone">
      <p>
        This is my phone number. For security reasons it has been included as an
        image.
      </p>
      <a href="images/phone-number.png"
         title="Personal phone number.">
        <img data-src="images/phone-number.png"
             style="margin-left: calc(50% - 175px/2);"
             width="175px"
             alt="Personal phone number." />
      </a>
      <p style="font-size: .8em; margin-top: 1.75em;">
        You can exit by pressing q or ESC or clicking outside this box.
      </p>
    </div>

    <div class="info" id="infoAddress">
      <p>
        This is my address. For security reasons it has been included as an
        image.
      </p>
      <a href="images/address.png"
         title="Personal phone number.">
        <img data-src="images/address.png"
             style="margin-left: calc(50% - 275px/2);"
             width="275px"
             alt="Personal address." />
      </a>
      <p style="font-size: .8em; margin-top: 2.5em;">
        You can exit by pressing q or ESC or clicking outside this box.
      </p>
    </div>

    <div id="blurBackground"></div>


    <!-- Heart. -->
    <div id="heart"><i class="fas fa-heart"></i></div>


    <!-- Zoomed images.  -->
    <div id="zoomImgDiv">
      <a href="javascript:closeZoomImg();" title="Close zoomed figure.">
        <i class="fas fa-times fa-2x"></i>
      </a>
      <figure>
        <img id="zoomImg" /><figcaption id="zoomImgCaption"></figcaption>
      </figure>
    </div>


    <!-- Header. -->
    <header>
      <div class="background">
        <img class="backgroundImage"
             data-src="images/backgrounds/autumn"
             alt="Background image: Autumn." />
        <img class="backgroundImage"
             data-src="images/backgrounds/beach"
             alt="Background image: Beach." />
        <img class="backgroundImage"
             data-src="images/backgrounds/flower"
             alt="Background image: Flower." />
        <img class="backgroundImage"
             data-src="images/backgrounds/leaves"
             alt="Background image: Leaves." />
        <img class="backgroundImage"
             data-src="images/backgrounds/lighthouse"
             alt="Background image: Lighthouse." />
        <img class="backgroundImage"
             data-src="images/backgrounds/mountain"
             alt="Background image: Mountain." />
        <img class="backgroundImage"
             data-src="images/backgrounds/stars"
             alt="Background image: Stars." />
      </div>
      <div class="overlay"></div>
      <a href="https://david.alvarezrosa.com/"
         title="David Álvarez Rosa's personal website.">
        <h1>David Álvarez Rosa</h1>
      </a>
      <h2>
        <strong>Mathematics</strong> and <br />
        <strong>Industrial Engineering</strong> student.
      </h2>
      <div id="sites">
        <a href="https://david.alvarezrosa.com/"
           title="David Álvarez Rosa's personal website.">
          Home
        </a>
        <a href="https://blog.alvarezrosa.com/"
           class="currentSite"
           title="David Álvarez Rosa's personal blog.">
          Blog
        </a>
        <a href="pdf/curriculum-vitae.pdf#view=Fit"
           title="My personal Curriculum Vitae.">
          CV
        </a>
      </div>
      <div id="controllers">
        <button id="backward"
                title="Show previous image."
                onclick="backwardAnimation();">
          <i class="fas fa-step-backward"></i>
        </button>
        <button id="pause"
                title="Toggle background animation state."
                onclick="toggleAnimation();">
          <i id="toggleIcon" class="fas fa-pause"></i>
        </button>
        <button id="forward"
                title="Show next image."
                onclick="forwardAnimation();">
          <i class="fas fa-step-forward"></i>
        </button>
      </div>
    </header>


    <!-- Navigation bar. -->
    <nav id="navBar">
      <div id="navBarDiv">
        <a class="current"
           href="#sec:intro"
           title="Scroll to introduction section.">
          Introduction
        </a>
        <a href="#sec:topology" title="Scroll to network topology section.">
          Topology
        </a>
        <a href="#sec:forward" title="Scroll to feed forward section.">
          Forward
        </a>
        <a href="#sec:optimize" title="Scroll to optimization problem section.">
          Optimization
        </a>
        <a href="#sec:backward" title="Scroll to backward propagation section.">
          Backward
        </a>
      </div>
      <button id="navBarButton"
              onclick="toggleNavBar();"
              title="Expand navigation bar.">
        <i class="fas fa-bars fa-2x"></i>
      </button>
    </nav>


    <!-- Navigation bar expanded. -->
    <nav id="navBarExpanded">
      <button id="navBarExpandedButton"
              onclick="toggleNavBar();"
              title="Hide expanded navigation bar.">
        <i class="fas fa-times fa-2x"></i>
      </button>
      <ul>
        <li class="title">
          Sections
        </li>
        <li>
          <a class="current"
             href="#sec:intro"
             title="Scroll to introduction section.">
            Introduction <i class="fas fa-percentage"></i>
          </a>
        </li>
        <li>
          <a href="#sec:topology" title="Scroll to network topology section.">
            Topology <i class="fas fa-project-diagram"></i>
          </a>
        </li>
        <li>
          <a href="#sec:forward" title="Scroll to feed forward section.">
            Forward <i class="fas fa-project-diagram"></i>
          </a>
        </li>
        <li>
          <a href="#sec:optimize" title="Scroll to optimization problem section.">
            Optimization <i class="fas fa-chart-line"></i>
          </a>
        </li>
        <li>
          <a href="#sec:backward" title="Scroll to backward propagation section.">
            Backward <i class="fas fa-chart-line"></i> <!-- TODO: change icon to -->
            <!-- backward arrow. -->
          </a>
        </li>
        <li>
          <p>
            @David &copy; 2020
          </p>
        </li>
      </ul>
    </nav>


    <!-- Scroll back to top button. -->
    <div id="scrollTop"
         onmouseover="document.getElementById('scrollTopSpan').style.display = 'inline-block';"
         onmouseout="document.getElementById('scrollTopSpan').style.display = 'none';">
      <a href="#" title="Scroll back to top.">
        <span id="scrollTopSpan">Go to top</span>
        <i class="fas fa-arrow-circle-up fa-2x"></i>
      </a>
    </div>


    <!-- Main. -->
    <main>
      <p class="fadeIn" style="margin-top: 2.5em;">
        This website does not (and won't ever) use cookies. I value your
        privacy.
      </p>

      <div class="anchor" id="sec:intro"></div>
      <section class="hidden">
        <h2> Introduction
          <a href="#sec:intro"
             title="Go to introduction section.">
            <i class="linkIcon fas fa-link"></i>
          </a>
          <i class="rightIcon fas fa-percentage"></i>
        </h2>
        <p>
          A <strong>neural network</strong>, more properly referred to as
          an <em>artificial</em> neural network (ANN) are computing system
          vaguely inspired by the biological neural networks that constitute
          animal brains. Dr.
          <a href="https://en.wikipedia.org/wiki/Robert_Hecht-Nielsen"
             rel="nofollow noopener"
             target="_blank"
             title="Robert Hecht-Nielsen - Wikipedia">
            Robert Hecht-Nielsen <i class="fas fa-external-link-alt"></i>
          </a>
          (inventor of one of the first neurocomputers) defines a neural network
          as:
        </p>
        <blockquote>
          <p>
            <i class="fas fa-pencil-alt fa-lg"></i>
            <em> ...a computing system made up of a number of simple, highly
              interconnected processing elements, which process information by
              their dynamic state response to external inputs.</em>
          </p>
          <p class="quoteAuthor">
            <a href="https://en.wikipedia.org/wiki/Robert_Hecht-Nielsen"
               rel="nofollow noopener"
               target="_blank"
               title="Robert Hecht-Nielsen - Wikipedia">
              ~Robert Hecht-Nielsen <i class="fas fa-external-link-alt"></i>
            </a>
          </p>
          <div class="clear"></div>
        </blockquote>
        <p>
          An ANN is based on a collection of connected units, that are called
          <em>artificial</em> <strong>neurons</strong>, which loosely model the
          neurons in a biological brain. Each connection, like the
          <a href="https://en.wikipedia.org/wiki/Synapse"
             rel="nofollow noopener"
             target="_blank"
             title="Robert Hecht-Nielsen - Wikipedia">
            synapses <i class="fas fa-external-link-alt"></i>
          </a>
          in a biological brain, can transmit a signal to other neurons. An
          artificial neuron that receives a signal then processes it and can
          signal neurons connected to it.
        </p>
        <div class="anchor" id="subsec:math-perspective"></div>
        <h3>
          Mathematical perspective
          <a href="#subsec:math-perspective"
             title="Go to mathematical perspective subsection.">
            <i class="linkIcon fas fa-hashtag"></i>
          </a>
        </h3>
        <p>
          Altough the analogy made above of an ANN with a biological brain,
          there is no need for this, we can just think of a neural network as an
          <strong>optimization</strong> problem. We can think of the whole
          network to be a function that takes some inputs to some outputs, this
          function is dependent on <strong>parameters</strong>. The idea is to
          adjust this parameters to get a function that works well with some
          known dataset, and we will rezaremos <!-- TODO: before --> that it
          will generalize well. If the network is big enough and we carefully
          adjust the parameters, we will be able to learn and calculate very
          complex functions.
        </p>
      </section>

      <div class="anchor" id="sec:topology"></div>
      <section class="hidden">
        <h2> Network topology
          <a href="#sec:topology"
             title="Go to network topology section.">
            <i class="linkIcon fas fa-link"></i>
          </a>
          <i class="rightIcon fas fa-project-diagram"></i>
        </h2>
        <div class="anchor" id="p:intro-toplogy"></div>
        <p>
          More concretly, in this blog series <!-- TODO: add link here. --> we
          will be discussing the <strong>fully-connected</strong> layered ANN,
          this is a case in which neurons are organized
          in <strong>layers</strong> and neurons between adjacent layers are
          required to be connected (and weighted). In the
          <a href="#fig:neural-network">figure 1</a> below, is shown an example
          of a fully connected neural network with two hidden layers.
        </p>
        <div class="anchor" id="fig:neural-network"></div>
        <figure>
          <img src="Neural Network.jpeg"
               alt="Fully connected neural network example with two hidden layers.">
          <figcaption>
            <strong>Figure 1</strong>: Fully connected ANN with two hidden layers.
          </figcaption>
        </figure>
        <div class="anchor" id="subsec:layers"></div>
        <h3>
          Layers
          <a href="#subsec:layers"
             title="Go to layers subsection.">
            <i class="linkIcon fas fa-hashtag"></i>
          </a>
        </h3>
        <p>
          The <strong>layers</strong> are just a collection of neurons, we will
          distinguish between three types depending on its position in the
          network.
        </p>
        <ul>
          <li>
            <strong>Input</strong> layer: patterns are presented to the
            network via this layer.
          </li>
          <li>
            <strong>Hidden</strong> layers: all the inner layers.
          </li>
          <li>
            <strong>Output</strong> layer: is the last layer, where
            the <em>answer</em> is obtained.
          </li>
        </ul>
        <p>
          We will denote with $L$ the number of layers and with $n_l$ the
          size of the $l$-th layer.
        </p>
        <p>
          To gain some intuition on how this work, let's think about the
          handwritten recognition problem. Suppose we have a set of images with
          handwritten digits in it and that we will like to implement an ANN
          that is capable of recognizing that digits. In this case, if the
          digits images are of 28x28 pixels, the <strong>input layer</strong>
          will consists of 784 (28x28) neurons and each neuron will hold the
          grayscale value of a pixel. For the <strong>output layer</strong> we
          will need 10 neurons (one for each number between 0 and 9), and we
          will like that when we <em>feed</em> our network with an image holding
          a handwritten number 3, then the ouput is one 1 in the position
          corresponding to the number 3 and the rest of zeros.
        </p>
        <div class="anchor" id="subsec:neurons"></div>
        <h3>
          Neurons
          <a href="#subsec:neurons"
             title="Go to optimization problem subsection.">
            <i class="linkIcon fas fa-hashtag"></i>
          </a>
        </h3>
        <p>
          Neurons are the core component of any neural network. Basically
          there are three subparts that form a neuron.
        </p>
        <ul>
          <li>
            <strong>Value</strong>: each neuron holds a value, it will be
            denoted by $x_i^l \in \mathbb{R}$ for the $i$-th neuron in the
            $l$-th layer. Of course, it should be satisfied $1 \leq i \leq n_l$.
          </li>
          <li>
            <strong>Bias</strong>: also each neuron has a bias, denoted as
            $b_i^l$ for the $i$-th neuron in the $l$-th layer. Is then
            true that $1 \leq i \leq n_l$.
          </li>
          <li>
            <strong>Activation function:</strong> all neurons have an activation
            function $f_i^l \in \mathcal{C}^1(\mathbb{R}, \mathbb{R})$ for the
            $i$-th neuron in the $l$-th layer. Of course, it is needed $1
            \leq i \leq n_l$.
          </li>
        </ul>
        <p> <!-- TODO: put this in an observations class. -->
          Usually all the activation functions are neuron-independent. The
          regularity assummed for this functions is important, since we will be
          optimizing in the future taking derivatives.
        </p>
        <div class="anchor" id="subsec:connections"></div>
        <h3>
          Connections
          <a href="#subsec:connections"
             title="Go to connections subsection.">
            <i class="linkIcon fas fa-hashtag"></i>
          </a>
        </h3>
        <p>
          As we discussed
          <a href="#p:intro-toplogy"
             title="Scroll to above discussion.">
            above</a>,
          all neurons between adjacent layers are required to be connected, this
          are the connections, that should have associated
          a <strong>weight</strong>. For the connection between the $i$-th
          neuron in the $l$-th layer and the $j$-th neuron in the $l+1$-th
          layer, we will denote this weight by $w_{ij}^l \in \mathbb{R} $. The
          set of all this weights is as follows, \[ \{w_{ij}^l \mid 1 \leq i
          \leq n_{l}, \, 1 \leq j \leq n_{l+1}, \, 1 \leq l < L \} \subset
          \mathbb{R}. \]
        </p>
      </section>

      <div class="anchor" id="sec:forward"></div>
      <section class="hidden">
        <h2> Feed forward
          <a href="#sec:forward"
             title="Go to feed forward section.">
            <i class="linkIcon fas fa-link"></i>
          </a>
          <i class="rightIcon fas fa-project-diagram"></i> <!-- TODO: change
          icon for a forward arrow. -->
        </h2>
        <p>
          From now on let's suppose we are working with a fully-connected neural
          network, with $L$ different layers and we will be using the same
          notation used before.' The values of the neurons can be computed as
          follows:
          \[
          x_i^l = f_i^l \left( \sum_{k=1}^{n_{l-1}} w_{ik}^{l-1} x_{k}^{l-1} +
          b_i^l \right).
          \]
        </p>
        <p>
          This formula is sometimes referred to as the feed-forward formula or
          forward propagation. It's important to note that it's a recursive
          formula, once the values the neurons in the the input layer are known,
          we can iterate computing the values of the neurons in the the next
          adjacent layer, until we reach the output layer. In this network we
          can think of <em>information</em> travelling in one direction,
          forward, from the input layer, through the hidden layers to the output
          neurons.
        </p>
      </section>

      <div class="anchor" id="sec:optimize"></div>
      <section class="hidden">
        <h2> Optimization problem
          <a href="#sec:optimize"
             title="Go to optimization problem section.">
            <i class="linkIcon fas fa-link"></i>
          </a>
          <i class="rightIcon fas fa-chart-line"></i>
        </h2>
        <p>
          In order to being able to <strong>train</strong> our neural network,
          is mandatory to define an <strong>error function</strong> (also known
          as loss function) that quantifies how <em>good</em> or <em>bad</em>
          the neural network is performing when <em>feeded</em> with a
          particular dataset.
        </p>
      </section>

      <div class="anchor" id="sec:backward"></div>
      <section class="hidden">
        <h2> Backward propagation
          <a href="#sec:backward"
             title="Go to backward propagation section.">
            <i class="linkIcon fas fa-link"></i>
          </a>
          <i class="rightIcon fas fa-chart-line"></i> <!-- TODO: change icon.  -->
        </h2>
        <p>
          First ñaslkdjf asdf kasjdf asd.
        </p>
      </section>

      <div class="sourceCode">
        <button onclick="copyToClipboard('prueba');" title="Copy to clipboard.">
          <i class="copy fas fa-clone fa-2x"></i>
          <i class="copyOkey fas fa-check-circle fa-2x"></i>
          <i class="copyError fas fa-exclamation-triangle fa-2x"></i>
        </button>

        <pre><code class="language-c++" id="prueba">#include
#include "Defs.hh"
#include "Math.hh"
#include "NeuralNetwork.hh"
#include "Data.hh"


int main() {
  std::cout.setf(std::ios::fixed);
  std::cout.precision(5);

  // Read data.
  const int sizeTrainDataset = 1;
  std::ifstream fileTrain("data/train.dat");
  for (int i = 0; i < sizeTrainDataset; ++i)
    trainDataset.push_back(Data(fileTrain));

  const int sizeTestDataset = 100;
  std::ifstream fileTest("data/test.dat");
  for (int i = 0; i < sizeTestDataset; ++i)
    testDataset.push_back(Data(fileTest));

  // Choose model and initialize Neural Network.
  NeuralNetwork neuralNetwork(neuronsPerLayer);

  // Train Neural Network.
  neuralNetwork.train(trainDataset, 5);

  // Test Neural Network.
  neuralNetwork.test(testDataset);
}</code></pre>
</div>

      <div id="blogControllers">
        <button class="blogButton blogPrevious"
                onclick="window.location.href = 'hello-world.html';">
          <i class="fas fa-arrow-left"></i> Previous blog entry
        </button>
        <button class="blogButton blogNext blogButtonInactive">
          Next blog entry <i class="fas fa-arrow-right"></i>
        </button>
      </div>
    </main>


    <!-- License (Creative Commons). -->
    <div id="license">
      <p id="copyright">
        Copyright &copy; 2019-2020
        <a href="https://david.alvarezrosa.com/"
           title="David Álvarez Rosa's personal website.">
          David Álvarez Rosa
        </a>
      </p>
      <a rel="license noopener"
         href="https://creativecommons.org/licenses/by-nc-sa/4.0/"
         target="_blank"
         title="Creative Commons Attribution-NonCommercial-ShareAlike 4.0 International License..">
        <img src="/images/license.png"
             alt="Creative Commons Attribution-NonCommercial-ShareAlike 4.0 International License.." />
      </a>
      <br />
      <p>
        This work is licensed under a
        <a rel="license noopener"
           href="https://creativecommons.org/licenses/by-nc-sa/4.0/"
           target="_blank"
           title="Creative Commons Attribution-NonCommercial-ShareAlike 4.0 International License.." >
          Creative Commons Attribution-NonCommercial-ShareAlike 4.0 International License.</a>
        <i class="fas fa-external-link-alt"></i>.
      </p>
      <hr />
      <p>
        Broken links and other corrections or suggestions can be sent
        to &lt;<a href="javascript:showInfo('welcomeUser');"
                  title="Web master email.">webmaster@alvarezrosa.com</a>&gt;.
      </p>
      <p>
        Last update: February 29, 2020.
      </p>
    </div>


    <!-- Footer. -->
    <footer>
      <div class="background">
        <img class="backgroundImage"
             data-src="images/backgrounds/autumn"
             alt="Background image: Autumn." />
        <img class="backgroundImage"
             data-src="images/backgrounds/beach"
             alt="Background image: Beach." />
        <img class="backgroundImage"
             data-src="images/backgrounds/flower"
             alt="Background image: Flower." />
        <img class="backgroundImage"
             data-src="images/backgrounds/leaves"
             alt="Background image: Leaves." />
        <img class="backgroundImage"
             data-src="images/backgrounds/lighthouse"
             alt="Background image: Lighthouse." />
        <img class="backgroundImage"
             data-src="images/backgrounds/mountain"
             alt="Background image: Mountain." />
        <img class="backgroundImage"
             data-src="images/backgrounds/stars"
             alt="Background image: Stars." />
      </div>
      <div class="overlay"></div>
      <ul>
        <li>
          <a class="fab fa-gitlab fa-2x"
             rel="external noopener"
             href="https://gitlab.com/DavidAlvarez"
             target="_blank"
             title="Personal Gitlab page.">
          </a>
          <br />
          Gitlab
        </li>
        <li>
          <a class="fab fa-linkedin fa-2x"
             style="padding-left: 5px;"
             rel="external noopener"
             href="https://www.linkedin.com/in/david-alvarez-rosa"
             target="_blank"
             title="Personal LinkedIn page.">
          </a>
          <br />
          LinkedIn
        </li>
        <li>
          <a class="fas fa-at fa-2x"
             href="javascript:showInfo('infoEmail');"
             title="Show my personal email.">
          </a>
          <br />
          Email
        </li>
        <li>
          <a class="fas fa-phone fa-2x"
             href="javascript:showInfo('infoPhone');"
             title="Show my personal phone number.">
          </a>
          <br />
          Phone
        </li>
        <li>
          <a class="fas fa-envelope fa-2x"
             href="javascript:showInfo('infoAddress');"
             title="Show my personal address.">
          </a>
          <br />
          Address
        </li>
      </ul>
      <p id="author" onmouseover="beatHeart();" onmouseout="hideHeart();">
        Designed with <i class="fas fa-heart fa-lg"></i> by
        <a href="https://david.alvarezrosa.com/"
           rel="author"
           title="David Álvarez Rosa's personal website.">
            @David
        </a>
      </p>
    </footer>


    <!-- Javascript files. -->
    <script src="js/main.js"></script>
    <script src="js/shortcuts.js"></script>
    <script src="js/confetti.js"></script>
    <!-- Include MathJax. -->
    <script id="MathJax-script" data-src="mathjax/tex-svg.js" async></script>










    <script src="highlight/highlight.pack.js"></script>
    <script src="highlight/highlight-line-numbers.min.js"></script>



    <script src="js/blog.js"></script>
  </body>
</html>
